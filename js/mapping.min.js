function cirClipper(a,c,b){a.save();a.beginPath();$.browser.chrome=/chrome/.test(navigator.userAgent.toLowerCase());$.browser.chrome?(a.drawImage(c,0,0),a.restore(),a.save(),a.beginPath(),a.globalCompositeOperation="destination-in",a.arc(b/2,b/2,b/2,0,2*Math.PI,!0),a.fillStyle="rgb(0, 0, 0)",a.fill()):(a.arc(b/2,b/2,b/2,0,2*Math.PI,!0),a.clip(),a.drawImage(c,0,0));a.restore()}function boxClipper(a,c,b,e){a.save();a.beginPath();a.rect(0,0,b,e);a.clip();a.drawImage(c,0,0);a.restore()}
function doClipping(a,c,b){var e=Math.round(parseInt(c.css("border-left-width"),10)),j=Math.round(parseInt(c.css("width"),10))+e,f=Math.round(parseInt(c.css("height"),10))+e,d=document.createElement("canvas"),g=d.getContext("2d");d.setAttribute("style","position: absolute; top:0px; left:0px; z-index:997;");d.setAttribute("class","canvas_appended");d.style.top=Math.round(parseInt(c.css("top"),10))+e+"px";d.style.left=Math.round(parseInt(c.css("left"),10))+e+"px";d.width=a.width;d.height=a.height;c.after(d);
b(g,a,j,f)}
function doMasking(a,c,b,e,j){var f=Math.round(parseInt(b.css("border-left-width"),10));e=Math.round(parseInt(b.css("left"),10))+f-e;j=Math.round(parseInt(b.css("top"),10))+f-j;var d=Math.round(parseInt(b.css("width"),10))+f,f=Math.round(parseInt(b.css("height"),10))+f;e+d>c.width&&(d=c.width-e);j+f>c.height&&(f=c.height-j);b=document.createElement("canvas");b.width=d;b.height=f;b.getContext("2d").drawImage(c,e,j,d,f,0,0,d,f);var g,h;d>=f?(g=d,h=Math.round(a.height*(g/a.width)),h<f&&(h=f,g=Math.round(a.width*
(h/a.height)))):d<f&&(h=f,g=Math.round(a.width*(h/a.height)),g<d&&(g=d,h=Math.round(a.height*(g/a.width))));e=document.createElement("canvas");e.width=g;e.height=h;e.getContext("2d").drawImage(a,0,0,g,h);a=document.createElement("canvas");a.width=g;a.height=h;a.getContext("2d").putImageData(applyCanvasMask(e,b,c.width,c.height),0,0);return a};