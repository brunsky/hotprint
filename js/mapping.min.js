function cirClipper(a,c,b){a.save();a.beginPath();$.browser.chrome=/chrome/.test(navigator.userAgent.toLowerCase());$.browser.chrome?(a.drawImage(c,0,0),a.restore(),a.save(),a.beginPath(),a.globalCompositeOperation="destination-in",a.arc(b/2,b/2,b/2,0,2*Math.PI,!0),a.fillStyle="rgb(0, 0, 0)",a.fill()):(a.arc(b/2,b/2,b/2,0,2*Math.PI,!0),a.clip(),a.drawImage(c,0,0));a.restore()}function boxClipper(a,c,b,d){a.save();a.beginPath();a.rect(0,0,b,d);a.clip();a.drawImage(c,0,0);a.restore()}
function doClipping(a,c,b){var d=Math.round(parseInt(c.css("border-left-width"),10)),h=Math.round(parseInt(c.css("width"),10))+d,j=Math.round(parseInt(c.css("height"),10))+d,e=document.createElement("canvas"),f=e.getContext("2d");e.setAttribute("style","position: absolute; top:0px; left:0px; z-index:997;");e.setAttribute("class","canvas_appended");e.style.top=Math.round(parseInt(c.css("top"),10))+d+"px";e.style.left=Math.round(parseInt(c.css("left"),10))+d+"px";e.width=a.width;e.height=a.height;c.after(e);
b(f,a,h,j)}
function doMasking(a,c,b,d,h){var j=Math.round(parseInt(b.css("border-left-width"),10));d=Math.round(parseInt(b.css("left"),10))+j-d;h=Math.round(parseInt(b.css("top"),10))+j-h;var e=Math.round(parseInt(b.css("width"),10))+j;b=Math.round(parseInt(b.css("height"),10))+j;var f,g;e>=b?(f=e,g=Math.round(a.height*(f/a.width)),g<b&&(g=b,f=Math.round(a.width*(g/a.height)))):e<b&&(g=b,f=Math.round(a.width*(g/a.height)),f<e&&(f=e,g=Math.round(a.height*(f/a.width))));b=document.createElement("canvas");b.width=
f;b.height=g;b.getContext("2d").drawImage(a,0,0,f,g);_maskW=d+f>c.width?c.width-d:f;_maskH=h+g>c.height?c.height-h:g;a=document.createElement("canvas");a.width=_maskW;a.height=_maskH;a.getContext("2d").drawImage(c,d,h,_maskW,_maskH,0,0,_maskW,_maskH);d=document.createElement("canvas");d.width=f;d.height=g;d.getContext("2d").putImageData(applyCanvasMask(b,a,c.width,c.height),0,0);return d};