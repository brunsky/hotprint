var SANDBOX=!1,HOST_URL="";SANDBOX?(HOST_URL="http://sandbox.hotprintcloud.com/",FBREDIRECT_URL="sandbox_fbredirect.html",INSTAREDIRECT_URL="sandbox_instaredirect.html",INSTAGRAM_CLIENT_ID="48fb462fd1254631a2c63416a01eb3f0",FACEBOOK_CLIENT_ID="396030097155221"):(HOST_URL="http://www.hotprintcloud.com/",FBREDIRECT_URL="fbredirect.html",INSTAREDIRECT_URL="instaredirect.html",INSTAGRAM_CLIENT_ID="c4b0c9a61cc24efbb4cd5feb71be67b8",FACEBOOK_CLIENT_ID="290426614419964");
var TEMP_DIR="proxy/tmp/",PHONE_NAME="iphone5",LAYOUT_NAME="layout_3",PHONE_COLOR="white",layout_ox=410,layout_oy=Math.floor(0.1*$(window).height()),CORNER_OPT=0.1,isCornerFading=!1,PAGE="Design",TITLE_NAME="",maskImg,isMenuEntry=!1,MY_LANG="en",DOLLAR_SIGN="$",_init,_getUserData,_displayUserData,_instaCrossLogin,_instalogin,_instalogout,_getUserRecent,_facebookPhotoAlbum,_fblogin,_fbCrossLogin,_fblogout,_logout,_loadLayout,_bindFunc,access_token,user_id,source_type;
(function(){function a(a){!1==isMenuEntry&&(isMenuEntry=!0,menuLoadLayout(a.data.param))}function b(a){!1==isMenuEntry&&(isMenuEntry=!0,menuLoadPhone(a.data.param))}function c(a){!1==isMenuEntry&&(isMenuEntry=!0,menuLoadColor(a.data.param))}$.extend({social_connect:function(){_init()}});_init=function(){$("html").removeClass("no-js");$("body").addClass("not-logged-in");$("#login").click({isPopup:!1},_instalogin);$("#login2").click({isPopup:!1},_fblogin);$("#facebook-source-login").click({isPopup:!0},
_fblogin);$("#instagram-source-login").click({isPopup:!0},_instalogin);$(".layout_item").each(function(e){$(this).click({param:$(this).attr("id")},a)});$(".phone_item").each(function(a){$(this).click({param:$(this).attr("id")},b)});$(".color_item").each(function(a){$(this).click({param:$(this).attr("id")},c)});if(""!=location.hash){var e=location.hash.split("&")[0],g=location.hash.split("&")[1],d=location.hash.split("&")[2];if(g){if("instagram"==g.split("=")[1])_instaCrossLogin(e.split("=")[1]);else if("facebook"==
g.split("=")[1])_fbCrossLogin(e.split("=")[1]);else{$.removeCookie("source");$.removeCookie("access_token");parent.location.hash="";return}parent.location.hash="";$.cookie("access_token",e.split("=")[1]);d&&"b"==d.split("=")[0]&&($("body").append('<div class="modalOverlay"></div>'),"succeed"==d.split("=")[1]?new Messi($.i18n.prop("Msg_20"),{title:$.i18n.prop("Msg_21"),buttons:[{id:0,label:"Close",val:"C"}],callback:function(a,e){$(".modalOverlay").remove();simpleCart.empty()}}):new Messi($.i18n.prop("Msg_22"),
{title:$.i18n.prop("Msg_23"),buttons:[{id:0,label:"Close",val:"C"}],callback:function(a,e){$(".modalOverlay").remove()}}))}else $.removeCookie("source"),$.removeCookie("access_token")}else $.cookie("access_token")&&$.cookie("source")&&("instagram"==$.cookie("source")?_instaCrossLogin($.cookie("access_token")):"facebook"==$.cookie("source")?_fbCrossLogin($.cookie("access_token")):($.removeCookie("source"),$.removeCookie("access_token"),parent.location.hash=""))};_bindFunc=function(){$("#save-design").unbind("click");
$("#random-design").unbind("click");$("#clear-design").unbind("click");$("#start-design").unbind("click");$("#my-gallery").unbind("click");$("#my-order-history").unbind("click");$("#logout").unbind("click");$("#go-to-my-gallery").unbind("click");$("#go-to-my-order-history").unbind("click");$("#save-design").bind("click",saveImg);$("#random-design").bind("click",randomDesign);$("#clear-design").bind("click",clearDesign);$("#start-design").bind("click",startDesign);$("#my-gallery").bind("click",openGallery);
$("#logout").bind("click",_logout);$("#go-to-my-gallery").bind("click",openGallery);$("#go-to-my-order-history").bind("click",openHistory)};_logout=function(){$("body").append('<div class="modalOverlay"></div>');$.removeCookie("source");$.removeCookie("access_token");$.removeCookie("user_id");$.removeCookie("phone_name");$.removeCookie("layout_name");$.removeCookie("phone_color");_fblogout(_instalogout)};var f;_instalogin=function(a){$(".recent").find(".draggable").each(function(a){$(this).remove();
$(this)[0]=null});f="";var g="https://instagram.com/oauth/authorize/?client_id="+INSTAGRAM_CLIENT_ID+"&amp;redirect_uri="+HOST_URL+INSTAREDIRECT_URL+"&amp;response_type=token";if(!0==a.data.isPopup)return window.open(g,"hotprintCloud","height=400,width=600,left=10,top=10,resizable=yes,scrollbars=yes,toolbar=no,menubar=no,location=no,directories=no,status=yes"),!1;window.location=g};_instalogout=function(a){$.ajax({url:"https://instagram.com/accounts/logout/",dataType:"jsonp",error:function(a){location.reload()},
success:function(a){location.reload()}})};_instaCrossLogin=function(a){access_token=a;source_type="instagram";null==$.cookie("source")&&$.cookie("source",source_type);$("body").addClass("logged-in");$(".tip").fadeOut(1E3);_getUserData()};_getUserData=function(){$.ajax({dataType:"jsonp",url:"https://api.instagram.com/v1/users/self",data:{access_token:access_token}}).success(_displayUserData)};_displayUserData=function(a){"200"!=a.meta.code?($.removeCookie("source"),$.removeCookie("access_token"),$("body").removeClass("logged-in"),
$("body").addClass("not-logged-in")):(user_id=a.data.id,"instagram"==$.cookie("source")&&($.cookie("user_id",user_id),$.cookie("user_type","instagram"),$(".open").html("").fadeIn(300).append(a.data.username)),f="",_getUserRecent())};_getUserRecent=function(a){0<$("#fbalbums").length&&$("#fbalbums").attr("disabled","disabled");$.ajax({dataType:"jsonp",url:null!=a?a:"https://api.instagram.com/v1/users/"+user_id+"/media/recent",data:{access_token:access_token,count:100}}).success(_displayUserRecent)};
_displayUserRecent=function(a){for(var b=0;b<a.data.length;b++)f+="<li><a><img src='loader.gif' delay_src=\""+a.data[b].images.standard_resolution.url+'" delay_src_h="'+a.data[b].images.standard_resolution.url+"\" id='recent_instaimg"+b+"' class='draggable draggable-h draggable-w gallery-pool' /></a></li>";"undefined"!=typeof a.pagination.next_url?_getUserRecent(a.pagination.next_url):gallery_bar_setting(f)};var h;_fblogin=function(a){$(".recent").find(".draggable").each(function(a){$(this).remove();
$(this)[0]=null});h="";var b="http://www.facebook.com/dialog/oauth/?client_id="+FACEBOOK_CLIENT_ID+"&redirect_uri="+HOST_URL+FBREDIRECT_URL+"&response_type=token&scope=user_photos";if(!0==a.data.isPopup)return window.open(b,"hotprintCloud","height=600,width=800,left=10,top=10,resizable=yes,scrollbars=yes,toolbar=no,menubar=no,location=no,directories=no,status=yes"),!1;window.location=b};_fbCrossLogin=function(a){$("#facebook-source").html("");access_token=a;source_type="facebook";null==$.cookie("source")&&
$.cookie("source",source_type);$("body").addClass("logged-in");$(".tip").fadeOut(1E3);FB.api("/me?access_token="+access_token+"&fields=albums,id,name",function(a){!a||a.error?($.removeCookie("source"),$.removeCookie("access_token"),$("body").removeClass("logged-in"),$("body").addClass("not-logged-in")):(user_id=a.id,"facebook"==$.cookie("source")&&($.cookie("user_id",user_id),$.cookie("user_type","facebook"),$(".open").html("").fadeIn(300).append(a.name)),$select=$("<select></select>"),$select.attr("id",
"fbalbums"),$.each(a.albums.data,function(a,b){$select.append($("<option></option>").attr("value",b.id).text(b.name))}),$("#facebook-source").append($select),$select.change(function(){$(".recent").find(".draggable").each(function(a){$(this).remove();$(this)[0]=null});h="";_facebookPhotoAlbum()}),h="",_facebookPhotoAlbum())})};_fblogout=function(a){FB.getLoginStatus(function(b){"connected"===b.status?FB.logout(function(b){"undefined"!=typeof a&&a()}):"undefined"!=typeof a&&a()})};_facebookPhotoAlbum=
function(a){var b=$.extend({facebookAlbumId:$("#fbalbums :selected").val(),photoLimit:"500",randomOrder:"false"}),c=b.facebookAlbumId,f=b.photoLimit;$.getJSON(null!=a?a+"&callback=?":"https://graph.facebook.com/"+c+"/photos?access_token="+access_token+"&limit=0&callback=?",function(a){0<$("#fbalbums").length&&$("#fbalbums").attr("disabled",!1);var b=f;a.data.length<b&&(b=a.data.length);for(i=0;i<b;i++){var e=a.data[i];h=e.width>e.height?h+("<li><a><img src='loader.gif' delay_src=\""+e.source+'" delay_src_h="'+
e.images[0].source+"\" id='recent_fbimg"+c+i+"' class='draggable draggable-h gallery-pool'/></a></li>"):h+("<li><a><img src='loader.gif' delay_src=\""+e.source+'" delay_src_h="'+e.images[0].source+"\" id='recent_fbimg"+c+i+"' class='draggable draggable-w gallery-pool'/></a></li>")}"undefined"!=typeof a.paging?"undefined"!=typeof a.paging.next?_facebookPhotoAlbum(a.paging.next):gallery_bar_setting(h):gallery_bar_setting(h)})}})(jQuery);
function show_price(a){$.post("db/bom.php",{part_name:a,lang:MY_LANG},function(a){"ok"==a.result&&($("#price_no").prev().remove("span"),"en"==MY_LANG?($("#price_no").before("<span>US$</span>"),DOLLAR_SIGN="US$"):"tw"==MY_LANG&&($("#price_no").before("<span>NT$</span>"),DOLLAR_SIGN="NT$"),$("#price_no").hide().html(""),$("#price_no").fadeIn(1E3).html(a.value))},"json")}
function gallery_bar_setting(a){$(".ad-thumb-list").html("").fadeIn(300).append(a);$(".gallery-pool").one("load",function(){$(this).attr("src",$(this).attr("delay_src"))}).each(function(){this.complete&&$(this).load()});$(".ad-gallery").adGallery({thumb_opacity:1});$(".ad-gallery").css("width",$(window).width()-50+"px");$(".ad-gallery").css({margin:"0 auto","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"});
$.browser.msie||$(".gallery-pool").hover(function(){$(this).css("opacity",0);var a=$(this).clone();a.css({left:$(this).position().left,top:$(this).position().top,width:$(this).css("width"),height:$(this).css("height"),position:"absolute",opacity:1,"box-shadow":"3px 3px 4px black","pointer-events":"none"});$(this).after(a);a.animate({top:"-=20",left:"-=5",width:"+=10",height:"+=10"},"fast")},function(){$(this).css("opacity",1);$(this).next().remove()});$(".gallery-pool").draggable({scroll:!1,cursor:"move",
helper:"clone",cursorAt:{left:35,top:35},revert:"invalid",drag:function(a,c){c.helper.css("z-index","1000");c.helper.css("opacity","0.7");0<=$(this).attr("class").indexOf("ui-draggable-dragging")&&$(".ui-draggable-dragging").css("z-index","1000");c.helper.height($(this).data("oh"));c.helper.width($(this).data("ow"))},start:function(a,c){disable_scroll();$(".layout_corner").css("z-index","998");$(".layout_corner").stop(!0,!0).animate({opacity:1});$(this).data("oh",Math.round(0.7*$(this).height()));
$(this).data("ow",Math.round(0.7*$(this).width()))},stop:function(a,c){enable_scroll();isCornerFading=!0;$(".layout_corner").animate({opacity:CORNER_OPT},{complete:function(){$(".layout_corner").each(function(){0<$(this).children(".spinning").length&&$(this).css("opacity","0")});isCornerFading=!1}})}})}
function clearCorner(a){"undefined"!=typeof a.attr("class")&&0<=a.attr("class").indexOf("layout_corner")&&(a.children(".draggable").each(function(a){$(this).remove();$(this)[0]=null}),a.css("cursor","default"),"canvas_appended"==a.next().attr("class")&&"canvas"==a.next()[0].tagName.toLowerCase()&&(a.next().remove(),a.next()[0]=null),a.removeClass("removed"),a.css("z-index","998"),$(".layout_corner").animate({opacity:CORNER_OPT},{complete:function(){$(".layout_corner > .draggable").parent().css("opacity",
"0")}}))}
function setDnD(a,b,c){var f=function(a,b){a.data("zdx",b.data("zdx"));a.data("zdy",b.data("zdy"));a.data("zw",b.data("zw"));a.data("zh",b.data("zh"));a.data("corner",b.data("corner"));if("undefined"!=typeof a.attr("src")&&(0<=a.attr("src").indexOf("http://")||0<=a.attr("src").indexOf("https://"))){var c=HOST_URL+TEMP_DIR+a.attr("src").replace(/\//g,"+");a.data("src",c);c=HOST_URL+TEMP_DIR+a.attr("delay_src_h").replace(/\//g,"+");a.data("src_h",c)}else a.data("src",b.data("src")),a.data("src_h",b.data("src_h"));
a.data("oh",b.data("oh"));a.data("ow",b.data("ow"))};$(".layout_corner").droppable({accept:".draggable",tolerance:"pointer",drop:function(h,e){if("undefined"!=typeof $(e.draggable).parent().attr("id")&&!(0<$(this).children(".spinner").length)){$(this).droppable("disable");enable_scroll();"canvas"==$(this).next()[0].tagName.toLowerCase()&&($(this).next().remove(),$(this).next()[0]=null);if($(e.draggable).parent().attr("id")!=$(this).attr("id"))$(this).html(""),$(this).append($(e.draggable).clone()),
$(e.draggable).parent().hasClass("layout_corner")&&removeUnclearWarning($(e.draggable).parent().attr("id")),removeUnclearWarning($(this).attr("id")),f($(this).children(".draggable"),$(e.draggable)),clearCorner($(e.draggable).parent());else{var g=$("<img>");f(g,$(e.draggable));$(this).html("");$(this).append($(e.draggable).clone());removeUnclearWarning($(this).attr("id"));f($(this).children(".draggable"),g)}$(this).children(".draggable").removeClass("gallery-pool");!1==isCornerFading&&$(".layout_corner").animate({opacity:CORNER_OPT},
{complete:function(){$(".layout_corner > .draggable").parent().css("opacity","0")}});$(this).children(".draggable").css({position:"relative",top:"0px",left:"0px",width:$(this).css("width"),height:$(this).css("height"),opacity:"0"});var g=$(this).children(".draggable").attr("src"),d=$(this);if(0<=$(this).children(".draggable").attr("class").indexOf("cached")){var k=new Image;"undefined"!=typeof d.children(".draggable").data("zdx")?(g=$("<canvas>"),g[0].width=parseInt(d.css("width"),10)+parseInt(d.css("border-left-width"),
10),g[0].height=parseInt(d.css("height"),10)+parseInt(d.css("border-left-width"),10),autoClipper2(d.children(".draggable")[0],g,d.children(".draggable").data("corner"),d),k.src=g[0].toDataURL(),k.width=g[0].width,k.height=g[0].height):k.src=g;k.onload=function(){0<=d.attr("class").indexOf("layout_circle")?doClipping(doMasking(k,a,d,b,c),d,cirClipper):0<=d.attr("class").indexOf("layout_square")&&doClipping(doMasking(k,a,d,b,c),d,boxClipper);d.css("opacity","0");setDragObj(d);d.droppable("enable")}}else{var l=
"#000";"black"==PHONE_COLOR&&(l="#FFF");var m=(new Spinner({lines:13,length:7,width:4,radius:10,corners:1,rotate:0,color:l,speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2E9,top:"auto",left:"auto"})).spin($(this)[0]);$.getImageData({url:g,server:HOST_URL+"proxy/getImageData.php",success:function(a){d.children(".draggable").attr("src",a.src);d.children(".draggable").addClass("cached");autoCentered(d,a);m.stop();d.css("opacity","0");setDragObj(d);d.droppable("enable")},error:function(a,
b){m.stop();d.droppable("enable")}})}}},out:function(a,b){0<$(this).children(".draggable").length&&0<=$(this).children(".draggable").attr("class").indexOf("ui-draggable-dragging")&&$(this).addClass("removed")},over:function(a,b){},deactivate:function(a,b){}})}
function menuLoadPhone(a){var b=function(a){PHONE_NAME=a;show_price(a);$.cookie("phone_name",PHONE_NAME);$(".device").find(".hovered").toggleClass("hovered");$("#"+a).parent().toggleClass("hovered");"iphone5"===a?($("#menu_type").html("iPhone 5").fadeIn(300),$("#white.color_item").parent().show(),$("#black.color_item").parent().show(),$("#trans.color_item").parent().show()):"iphone4"===a?($("#menu_type").html("iPhone 4/4S").fadeIn(300),PHONE_COLOR="white",$.cookie("phone_color",PHONE_COLOR),$("#menu_color").html($.i18n.prop("Msg_13")).fadeIn(300),
$("#white.color_item").parent().show(),$("#black.color_item").parent().hide(),$("#trans.color_item").parent().hide()):"s3"===a?($("#menu_type").html("Galaxy S3").fadeIn(300),"black"==PHONE_COLOR&&(PHONE_COLOR="white",$.cookie("phone_color",PHONE_COLOR),$("#menu_color").html($.i18n.prop("Msg_13")).fadeIn(300)),$("#white.color_item").parent().show(),$("#black.color_item").parent().hide(),$("#trans.color_item").parent().show()):"onex"===a&&($("#menu_type").html("HTC One X").fadeIn(300),"black"==PHONE_COLOR&&
(PHONE_COLOR="white",$.cookie("phone_color",PHONE_COLOR),$("#menu_color").html($.i18n.prop("Msg_13")).fadeIn(300)),$("#white.color_item").parent().show(),$("#black.color_item").parent().hide(),$("#trans.color_item").parent().show());$(".color").find(".hovered").toggleClass("hovered");$("#"+PHONE_COLOR).parent().toggleClass("hovered");setCanvas(a)};0!=$(".canvas_appended").length?($("body").append('<div class="modalOverlay"></div>'),new Messi($.i18n.prop("Msg_24"),{title:$.i18n.prop("Msg_25"),buttons:[{id:0,
label:"Yes",val:"Y"},{id:1,label:"No",val:"N"}],callback:function(c){$(".modalOverlay").remove();$(".layout_corner").animate({opacity:CORNER_OPT});"Y"===c?($(".layout_corner").length&&$(".layout_corner").children(".draggable").each(function(a){$(this).remove();$(this)[0]=null}),$(".canvas_appended").length&&$(".canvas_appended").each(function(a){$(this).remove();$(this)[0]=null}),b(a)):isMenuEntry=!1}})):b(a)}
function menuLoadColor(a){var b=function(a){PHONE_COLOR=a;$.cookie("phone_color",PHONE_COLOR);setCanvas(PHONE_NAME);$(".color").find(".hovered").toggleClass("hovered");$("#"+a).parent().toggleClass("hovered");"white"===a?$("#menu_color").html($.i18n.prop("Msg_13")).fadeIn(300):"black"===a?$("#menu_color").html($.i18n.prop("Msg_14")).fadeIn(300):"trans"===a&&$("#menu_color").html($.i18n.prop("Msg_15")).fadeIn(300)};0!=$(".canvas_appended").length?($("body").append('<div class="modalOverlay"></div>'),
new Messi($.i18n.prop("Msg_26"),{title:$.i18n.prop("Msg_26_1"),buttons:[{id:0,label:"Yes",val:"Y"},{id:1,label:"No",val:"N"}],callback:function(c){$(".modalOverlay").remove();$(".layout_corner").animate({opacity:CORNER_OPT});"Y"===c?($(".layout_corner").length&&$(".layout_corner").children(".draggable").each(function(a){$(this).remove();$(this)[0]=null}),$(".canvas_appended").length&&$(".canvas_appended").each(function(a){$(this).remove();$(this)[0]=null}),b(a)):isMenuEntry=!1}})):b(a)}
function menuLoadLayout(a){var b=function(a){LAYOUT_NAME=a;$.cookie("layout_name",LAYOUT_NAME);loadLayout(maskImg,layout_ox,layout_oy,PHONE_NAME+"_"+LAYOUT_NAME);$("#menu_layout").html(a.replace("_"," ")).fadeIn(300);$(".layout").find(".hovered").toggleClass("hovered");$("#"+a).toggleClass("hovered")};0!=$(".canvas_appended").length?($("body").append('<div class="modalOverlay"></div>'),new Messi($.i18n.prop("Msg_27"),{title:$.i18n.prop("Msg_27_1"),buttons:[{id:0,label:"Yes",val:"Y"},{id:1,label:"No",
val:"N"}],callback:function(c){$(".modalOverlay").remove();$(".layout_corner").animate({opacity:CORNER_OPT});"Y"===c?($(".layout_corner").length&&$(".layout_corner").children(".draggable").each(function(a){$(this).remove();$(this)[0]=null}),$(".canvas_appended").length&&$(".canvas_appended").each(function(a){$(this).remove();$(this)[0]=null}),b(a)):isMenuEntry=!1}})):b(a)}
function loadLayout(a,b,c,f){$(".layout_corner").each(function(a){$(this).remove();$(this)[0]=null});$(".canvas_appended").each(function(a){$(this).remove();$(this)[0]=null});$(".warning").remove();$("link[type='text/css']#layout_css").remove();a=jQuery("<link>");a.attr({rel:"stylesheet",type:"text/css",href:"css/"+f+".css?v="+(new Date).getTime(),id:"layout_css"});$("head").append(a);styleOnload(a[0],function(){var a="js/"+f+".js?v="+(new Date).getTime();$.getScript(a).done(function(a,f,d){setDnD(maskImg,
b,c);isMenuEntry=!1}).fail(function(a,b,c){isMenuEntry=!1})})}function setContainer(){var a=$(window).height();$(document).height();$("#wrapper").css("height",a-$(".recent").height()+"px");1224>=$(document).width()?$(".mainmenu").css("width","1224px"):$(".mainmenu").css("width","100%")}function setFooterTop(){$("#tip1").css("left",Math.round(parseInt($("#popbox > .open").offset().left,10))-60);$("#tip3").css("left",Math.round(parseInt($("#popbox > .open").offset().left,10))-160)}
function setCanvas(a){0<$("#mCanvas").length&&($("#mCanvas").remove(),$("#mCanvas")[0]=null);$(".warning").remove();var b=document.createElement("Canvas");b.setAttribute("id","mCanvas");var c=b.getContext("2d");$(".mainmenu").before(b);$(window).height();$(window).width();layout_oy=66;layout_ox=404;$("#mCanvas").css("top",layout_oy+"px");$("#mCanvas").css("left",layout_ox+"px");$(".mTitle").fadeIn(3E3);var f=new Image;f.src="images/"+a+"_"+PHONE_COLOR+".png";f.onload=function(){$("#mCanvas")[0].width=
f.width;$("#mCanvas")[0].height=f.height;c.drawImage(f,0,0,f.width,f.height)};$.getImageData({url:HOST_URL+"images/"+a+"_mask.png",server:HOST_URL+"proxy/getImageData.php",success:function(a){maskImg=a;menuLoadLayout(LAYOUT_NAME);loadPriceTag(!0)},error:function(a,b){}})}
function setAccordionMenu(){var a=$(".accordion > li > a"),b=$(".accordion li > .sub-menu");a.first().addClass("active").next().slideDown("normal");a.click(function(c){c.preventDefault();"active"!=$(this).attr("class")&&(b.slideUp("normal"),$(this).next().stop(!0,!0).slideToggle("normal"),a.removeClass("active"),$(this).addClass("active"))})}function saveImg(){mod_saving(function(){removeUnclearWarning("_big");releasePage("Design");newPage("Gallery")})}function randomDesign(){mod_randesign()}
function startDesign(){releasePage(PAGE);newPage("Design")}function openGallery(){openFromMainMenu("Gallery")}function openHistory(){openFromMainMenu("Order_History")}
function openFromMainMenu(a){"Checkout"==PAGE?($("body").append('<div class="modalOverlay"></div>'),new Messi($.i18n.prop("Msg_28"),{title:$.i18n.prop("Msg_29"),buttons:[{id:0,label:"Yes",val:"Y"},{id:1,label:"No",val:"N"}],callback:function(b,c){"Y"===b&&(releasePage(PAGE),newPage(a));$(".modalOverlay").remove()}})):"Design"==PAGE&&0!=$(".canvas_appended").length?($("body").append('<div class="modalOverlay"></div>'),new Messi($.i18n.prop("Msg_30"),{title:$.i18n.prop("Msg_31"),buttons:[{id:0,label:"Yes",
val:"Y"},{id:1,label:"No",val:"N"}],callback:function(b,c){"Y"===b&&(removeUnclearWarning("_big"),releasePage(PAGE),newPage(a));$(".modalOverlay").remove()}})):(releasePage(PAGE),newPage(a))}
function newPage(a){PAGE=a;"Design"==a?($("#menubar").fadeIn(300),$(".recent").fadeIn(300),$("#random-design").fadeIn(300),$("#clear-design").fadeIn(300),$("#save-design").fadeIn(300),setCanvas(PHONE_NAME),"facebook"==source_type?_fbCrossLogin(access_token):"instagram"==source_type&&_instaCrossLogin(access_token),$("#mTitle").html(TITLE_NAME),$("#mTitle").editable(function(a,c){return TITLE_NAME=$.trim(a)},{onblur:"submit",placeholder:$.i18n.prop("Msg_32"),tooltip:$.i18n.prop("Msg_33"),style:"display: inline"})):
"Save"==a?($("#start-design").fadeIn(300),$("#my-gallery").fadeIn(300)):"Gallery"==a?($("#start-design").fadeIn(300),mod_gallery()):"Checkout"==a?mod_checkout():"Order_History"==a&&($("#start-design").fadeIn(300),mode_history())}
function releasePage(a){"Design"==a?($("#random-design").hide(),$("#clear-design").hide(),$("#save-design").hide(),$("#menubar").hide(),$("#mCanvas").remove(),$("#mCanvas")[0]=null,$("#mTitle").html(""),$(".warning").remove(),$(".recent").find(".draggable").each(function(a){$(this).remove();$(this)[0]=null}),$(".recent").hide(),$(".ad-preloads").remove(),$(".ad-preloads")[0]=null,loadPriceTag(!1),$(".layout_corner").length&&($(".layout_corner").children(".draggable").each(function(a){$(this).remove();
$(this)[0]=null}),$(".layout_corner").each(function(a){$(this).remove();$(this)[0]=null})),$(".canvas_appended").length&&$(".canvas_appended").each(function(a){$(this).remove();$(this)[0]=null}),$("#galleryCanvas").length&&($("#galleryCanvas").remove(),$("#galleryCanvas")[0]=null)):"Save"==a?($("#start-design").hide(),$("#my-gallery").hide(),$("#galleryCanvas").remove(),$("#galleryCanvas")[0]=null):"Gallery"==a?($("#start-design").hide(),$("#gallery").remove(),$("#gallery")[0]=null,$(".shopping_cart").remove(),
$(".shopping_cart")[0]=null,$(".shopping_cart2").remove(),$(".shopping_cart2")[0]=null):"Checkout"==a?$(".order").remove():"Order_History"==a&&($("#start-design").hide(),$(".order_history").remove())}function loadPriceTag(a){!0==a?($("#price_tag").show(),$("#price_tag").css("left",370+layout_ox+"px"),$("#price_tag").css("top",80+layout_oy+"px")):$("#price_tag").hide()}
$(function(){simpleCart.load();null==$.cookie("lang")?($.cookie("lang","en",{path:"/"}),MY_LANG="en",simpleCart.empty()):MY_LANG=$.cookie("lang");$.i18n.properties({name:"Messages",path:"lang/",mode:"map",language:MY_LANG,callback:function(){$("#logo").attr("title",$.i18n.prop("Msg_1"));$("#start-design").html($.i18n.prop("Msg_2"));$("#clear-design").html($.i18n.prop("Msg_3"));$("#random-design").html($.i18n.prop("Msg_4"));$("#save-design").html($.i18n.prop("Msg_5"));$("#my-gallery").html($.i18n.prop("Msg_6"));
$("#go-to-my-gallery").html($.i18n.prop("Msg_6"));$(".open").html($.i18n.prop("Msg_7"));$("#go-to-my-order-history").html($.i18n.prop("Msg_8"));$("#logout").html($.i18n.prop("Msg_9"));$("#instagram-source-login").attr("title",$.i18n.prop("Msg_18","Instagram"));$("#facebook-source-login").attr("title",$.i18n.prop("Msg_18","facebook"));$("#trans_fee_text").html($.i18n.prop("Msg_19"));$("#model_name").html($("#model_name").html().replace("{Msg_10}",$.i18n.prop("Msg_10")));$("#model_layout").html($("#model_layout").html().replace("{Msg_11}",
$.i18n.prop("Msg_11")));$("#model_color").html($("#model_color").html().replace("{Msg_12}",$.i18n.prop("Msg_12")));$("#menu_color").html($("#menu_color").html().replace("{Msg_13}",$.i18n.prop("Msg_13")));$("#white").html($("#white").html().replace("{Msg_13}",$.i18n.prop("Msg_13")));$("#black").html($("#black").html().replace("{Msg_14}",$.i18n.prop("Msg_14")));$("#trans").html($("#trans").html().replace("{Msg_15}",$.i18n.prop("Msg_15")));$("#menubar").fadeIn(300);main()}})});
function main(){-1!=navigator.userAgent.indexOf("Firefox")&&$("body").css("overflow","auto");$("body").iealert({support:"ie8",title:$.i18n.prop("Msg_34"),text:$.i18n.prop("Msg_35"),upgradeTitle:$.i18n.prop("Msg_36")});setAccordionMenu();setContainer();setFooterTop();$.cookie("phone_name")&&(PHONE_NAME=$.cookie("phone_name"));$.cookie("phone_color")&&(PHONE_COLOR=$.cookie("phone_color"),"white"===PHONE_COLOR?$("#menu_color").html($.i18n.prop("Msg_13")).fadeIn(300):"black"===PHONE_COLOR?$("#menu_color").html($.i18n.prop("Msg_14")).fadeIn(300):
"trans"===PHONE_COLOR&&$("#menu_color").html($.i18n.prop("Msg_15")).fadeIn(300));$.cookie("layout_name")&&(LAYOUT_NAME=$.cookie("layout_name"));menuLoadPhone(PHONE_NAME);simpleCart({cartColumns:[{view:function(a,b){return a.get("name")},attr:"name",label:$.i18n.prop("Msg_37")},{attr:"price",label:$.i18n.prop("Msg_38"),view:"currency"},{attr:"title",label:"Title"},{attr:"image",label:"Image"},{view:"decrement",label:!1,text:"-"},{view:function(a,b){return a.quantity()},attr:"quantity",label:$.i18n.prop("Msg_39")},
{view:"increment",label:!1,text:"+"},{view:function(a,b){return simpleCart.toCurrency(a.get("total"))},attr:"total",label:$.i18n.prop("Msg_40")},{view:"remove",text:$.i18n.prop("Msg_41"),label:!1}]});"tw"==MY_LANG?(simpleCart.currency("NTD"),$("#tip1").css("background-image","url(css/images/icons2.png)").fadeIn(1E3),$("#tip2").css("background-image","url(css/images/icons2.png)").fadeIn(1E3),$("#tip3").css("background-image","url(css/images/icons2.png)").fadeIn(1E3)):(simpleCart.currency("USD"),$("#tip1").css("background-image",
"url(css/images/icons2_en.png)").fadeIn(1E3),$("#tip2").css("background-image","url(css/images/icons2_en.png)").fadeIn(1E3),$("#tip3").css("background-image","url(css/images/icons2_en.png)").fadeIn(1E3));$("#mTitle").editable(function(a,b){return TITLE_NAME=$.trim(a)},{onblur:"submit",placeholder:$.i18n.prop("Msg_32"),tooltip:$.i18n.prop("Msg_33"),style:"display: inline"});$.social_connect();$("#start-design").hide();$("#my-gallery").hide();$("#popbox").popbox();simpleCart.ready(function(){_bindFunc()})}
$(window).resize(function(){setContainer();setFooterTop()});$(window).scroll(function(){setFooterTop()});window.console||(window.console={});window.console.log||(window.console.log=function(){});
